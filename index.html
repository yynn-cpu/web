<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å¤§ç¬¨æ¡¶å®ç›˜å…¨èƒ½æ‰«æå™¨ - æœ€ç»ˆç¨³å®šç‰ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --g-blue: #1a73e8; --g-green: #34a853; --g-red: #ea4335; --g-grey: #5f6368; }
        body { font-family: 'Google Sans', sans-serif; background: #f8f9fa; color: #202124; margin: 0; padding: 20px; }
        .header { max-width: 1100px; margin: 0 auto 20px; display: flex; justify-content: space-between; align-items: center; }
        .card { max-width: 1100px; margin: 0 auto; background: #fff; border-radius: 8px; box-shadow: 0 1px 3px rgba(60,64,67,0.3); overflow: hidden; }
        .status-bar { padding: 10px 20px; background: #e8f0fe; color: var(--g-blue); font-size: 13px; display: flex; align-items: center; gap: 10px; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 15px; background: #fafafa; border-bottom: 1px solid #eee; color: var(--g-grey); font-size: 13px; }
        td { padding: 15px; border-bottom: 1px solid #f1f3f4; font-size: 14px; }
        .symbol { font-weight: bold; color: var(--g-blue); }
        .tag { font-size: 11px; background: #f1f3f4; padding: 2px 6px; border-radius: 4px; color: #555; }
        .loading-text { color: #999; font-style: italic; }
    </style>
</head>
<body>

    <div class="header">
        <h1 style="font-size: 22px; color: var(--g-grey); margin: 0;">ğŸ’ ç­–ç•¥ç²¾å‡†ç›‘æ§ (æ— ä»£ç†ç‰ˆ)</h1>
        <div class="status-bar"><span id="status">æ•°æ®åŒæ­¥ä¸­...</span></div>
    </div>

    <div class="card">
        <table>
            <thead>
                <tr>
                    <th>äº¤æ˜“å¯¹</th>
                    <th>ç°ä»·/å¼€ç›˜</th>
                    <th>24h æ¶¨å¹…</th>
                    <th>åç¦»åº¦</th>
                    <th>24h é«˜ä½ä½</th>
                    <th>ç­–ç•¥çŠ¶æ€</th>
                </tr>
            </thead>
            <tbody id="resBody">
                <tr><td colspan="6" style="text-align:center; padding:60px; color:#999;">æ­£åœ¨ç›‘å¬å®æ—¶è¡Œæƒ…æµ...</td></tr>
            </tbody>
        </table>
    </div>

<script>
    const resBody = document.getElementById('resBody');
    const status = document.getElementById('status');
    const signalData = {}; 

    // å»ºç«‹ WebSocket - è®¢é˜…å…¨åœº 24h ç»Ÿè®¡
    // è¿™ç§æ•°æ®åŒ…é‡Œè‡ªå¸¦äº†ï¼šo (å¼€ç›˜), c (ç°ä»·), h (24hæœ€é«˜), l (24hæœ€ä½)
    const socket = new WebSocket('wss://fstream.binance.com/ws/!ticker@arr');

    socket.onopen = () => { status.innerText = "å®æ—¶è¿æ¥æˆåŠŸ (å·²è·³è¿‡ CORS é™åˆ¶)"; };

    socket.onmessage = (event) => {
        const data = JSON.parse(event.data);
        
        // ç­›é€‰é€»è¾‘ï¼šæ¶¨å¹… >= 5% 
        const activeList = data.filter(item => item.s.endsWith('USDT') && parseFloat(item.P) >= 5);
        
        activeList.sort((a, b) => parseFloat(b.P) - parseFloat(a.P));

        if (activeList.length === 0) {
            resBody.innerHTML = '<tr><td colspan="6" style="text-align:center; padding:60px; color:#999;">å½“å‰å¸‚åœºæš‚æ— æ¶¨å¹…è¶…è¿‡ 5% çš„æ ‡çš„</td></tr>';
            return;
        }

        resBody.innerHTML = activeList.map(s => {
            const cur = parseFloat(s.c);
            const open = parseFloat(s.o);
            const high = parseFloat(s.h);
            const low = parseFloat(s.l);
            const dev = ((open - cur) / open * 100).toFixed(2);
            
            // æ¨¡æ‹Ÿä½ çš„ç­–ç•¥é€»è¾‘åˆ¤æ–­ (åŸºäº 24h ä»·æ ¼å½¢æ€)
            let strategyTip = "è§‚å¯Ÿä¸­";
            if (cur < high * 0.98 && cur > open) strategyTip = "âœ… å†²é«˜å›è½ (5%ç‰¹å¾)";
            if (cur < open) strategyTip = "âš ï¸ å·²è·Œç ´å¼€ç›˜ (åç¦»è¿‡å¤§)";

            return `
                <tr>
                    <td><span class="symbol">${s.s}</span></td>
                    <td>${cur.toFixed(4)} / ${open.toFixed(4)}</td>
                    <td style="color:var(--g-green); font-weight:bold;">+${s.P}%</td>
                    <td>${dev}%</td>
                    <td style="font-size:12px; color:var(--g-grey)">
                        é«˜: ${high.toFixed(4)}<br>ä½: ${low.toFixed(4)}
                    </td>
                    <td><span class="tag">${strategyTip}</span></td>
                </tr>
            `;
        }).join('');
    };

    socket.onclose = () => { status.innerText = "è¿æ¥æ–­å¼€ï¼Œè¯·åˆ·æ–°"; };
</script>
</body>
</html>
