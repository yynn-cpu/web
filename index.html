<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å¤§ç¬¨æ¡¶ - å®æ—¶è¡Œæƒ…ç›‘æ§</title>
    <style>
        body { font-family: sans-serif; background: #121213; color: #eaeaeb; padding: 20px; }
        .container { max-width: 800px; margin: auto; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .online { background: #02c076; box-shadow: 0 0 5px #02c076; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; color: #848e9c; font-size: 12px; padding: 10px; }
        td { padding: 15px 10px; border-bottom: 1px solid #2b2f36; font-family: 'Courier New', monospace; }
        .symbol { font-weight: bold; color: #f0b90b; }
        .price { color: #fff; }
        .percent { font-weight: bold; }
        .up { color: #02c076; }
        .down { color: #cf304a; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2>ğŸ“Š åˆçº¦å®æ—¶å¼ºä¿¡å· (24h > 5%)</h2>
            <div>
                <span id="dot" class="status-dot"></span>
                <span id="status">æ­£åœ¨è¿æ¥å¸å®‰æ•°æ®æº...</span>
            </div>
        </div>
        <table id="marketTable">
            <thead>
                <tr>
                    <th>äº¤æ˜“å¯¹</th>
                    <th>å½“å‰ä»·æ ¼</th>
                    <th>24h æ¶¨å¹…</th>
                </tr>
            </thead>
            <tbody id="tickerBody">
                </tbody>
        </table>
    </div>

    <script>
        const tickerBody = document.getElementById('tickerBody');
        const statusText = document.getElementById('status');
        const dot = document.getElementById('dot');

        // 1. è¿æ¥å¸å®‰æ‰€æœ‰åˆçº¦çš„ 24h ç»Ÿè®¡æµ (All Market Tickers)
        // è¿™ä¸ªæ¥å£æ¯ç§’æ¨é€ä¸€æ¬¡å…¨åœºè¡Œæƒ…ï¼Œä¸”ä¸é™åˆ¶æµè§ˆå™¨ IP
        const ws = new WebSocket('wss://fstream.binance.com/ws/!ticker@arr');

        ws.onopen = () => {
            statusText.innerText = "å·²è¿æ¥ (å®æ—¶æ›´æ–°ä¸­)";
            dot.classList.add('online');
        };

        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            
            // 2. ç­–ç•¥ç­›é€‰ï¼šåªçœ‹ USDT ç»“ç®—ï¼Œä¸”æ¶¨å¹… >= 5% çš„å¸ç§
            const signals = data.filter(item => 
                item.s.endsWith('USDT') && parseFloat(item.P) >= 5
            );

            // 3. æ’åºï¼šæŒ‰æ¶¨å¹…ä»é«˜åˆ°ä½
            signals.sort((a, b) => parseFloat(b.P) - parseFloat(a.P));

            // 4. æ›´æ–° UI
            if (signals.length === 0) {
                tickerBody.innerHTML = '<tr><td colspan="3" style="text-align:center; color:#555;">æš‚æ— ç¬¦åˆ 5% æ¶¨å¹…çš„å¼ºåŠ¿å¸</td></tr>';
            } else {
                tickerBody.innerHTML = signals.map(s => `
                    <tr>
                        <td class="symbol">${s.s}</td>
                        <td class="price">${parseFloat(s.c).toFixed(4)}</td>
                        <td class="percent ${parseFloat(s.P) >= 0 ? 'up' : 'down'}">
                            ${parseFloat(s.P) >= 0 ? '+' : ''}${s.P}%
                        </td>
                    </tr>
                `).join('');
            }
        };

        ws.onerror = (err) => {
            statusText.innerText = "è¿æ¥å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ";
            dot.classList.remove('online');
        };

        ws.onclose = () => {
            statusText.innerText = "è¿æ¥å·²æ–­å¼€ï¼Œè¯·åˆ·æ–°é¡µé¢";
            dot.classList.remove('online');
        };
    </script>
</body>
</html>